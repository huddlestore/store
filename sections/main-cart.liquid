{%- capture section_settings -%}
{
  "showShippingEstimator": {% if cart.item_count == 0 %}false{% else %}{{ section.settings.show_shipping_estimator | json }}{% endif %}
}
{%- endcapture -%}

<section
  data-section-id="{{ section.id }}"
  data-section-type="cart"
  data-section-settings="{{ section_settings }}"
  data-item-count="{{ cart.item_count }}"
>
  {%- if cart.item_count == 0 -%}
    <div class="container">
      <div class="empty-state">
        <div class="empty-state__icon">
          {%- render 'icon', icon: 'big-cart' -%}
        </div>

        <p class="empty-state__heading heading h1">{{ 'cart.general.empty' | t }}</p>

        {%- if settings.cart_show_free_shipping_threshold -%}
          {%- assign threshold_in_cents = settings.cart_free_shipping_threshold | times: 100 -%}
          {%- capture remaining_amount -%}<span>{{ cart.total_price | minus: threshold_in_cents | abs | money }}</span>{%- endcapture -%}
          <p class="empty-state__description">
            {{ 'cart.general.free_shipping_remaining_html' | t: remaining_amount: remaining_amount }}
          </p>
        {%- endif -%}

        <div class="empty-state__button-container">
          <a
            href="{{ settings.cart_empty_button_link | default: routes.root_url }}"
            class="empty-state__button button button--primary"
          >
            {{- 'cart.general.empty_button' | t -}}
          </a>
        </div>
      </div>
    </div>
  {%- else -%}
    <div class="container">
      <header class="page__header page__header--stack">
        <h1 class="page__title heading h1">{{ 'cart.general.title' | t }}</h1>
      </header>
    </div>

    <div class="cart-wrapper">
      <div class="cart-wrapper__inner">
        <div class="cart-wrapper__inner-inner">
          <div class="container container--flush">
            {%- comment -%}
              --------------------------------------------------------------------------------------
              LINE ITEMS
              --------------------------------------------------------------------------------------
            {%- endcomment -%}

            <div class="card">
              <div class="table-wrapper">
                <table class="line-item-table table table--loose">
                  <thead class="hidden-phone">
                    <tr>
                      <th style="border-right: 2px solid #dcdcdc;font-weight: 600;background: #efefef; border-radius: 10px 0px 0px 10px;">
                        {{ 'customer.order.product' | t }}
                      </th>
                      <th
                        class="table__cell--center"
                        style="border-right: 2px solid #dcdcdc;font-weight: 600;background: #efefef;"
                      >
                        {{ 'customer.order.quantity' | t }}
                      </th>
                      <th
                        class="table__cell--right"
                        style="font-weight: 600;background: #efefef;border-radius: 0px 10px 10px 0px;"
                      >
                        {{ 'customer.order.total' | t }}
                      </th>
                    </tr>
                  </thead>

                  <tbody>
                    {%- assign gift_wrap_product = all_products[section.settings.gift_wrap_product] -%}

                    {%- for line_item in cart.items -%}
                      <tr class="line-item line-item--stack">
                        <td class="line-item__product-info">
                          <div class="line-item__product-info-wrapper">
                            <div class="line-item__image-wrapper">
                              {%- comment -%}For vertical images we force to contain them on a square ratio to avoid growing too large{%- endcomment -%}

                              {%- if line_item.image.aspect_ratio < 1 -%}
                                <div class="aspect-ratio aspect-ratio--square">
                                  <img
                                    src="{{ line_item.image | img_url: '180x' }}"
                                    alt="{{ line_item.image.alt | escape }}"
                                  >
                                </div>
                              {%- else -%}
                                <div
                                  class="aspect-ratio"
                                  style="padding-bottom: {{ 100.0 | divided_by: line_item.image.aspect_ratio }}%"
                                >
                                  <img
                                    src="{{ line_item.image | img_url: '180x' }}"
                                    alt="{{ line_item.image.alt | escape }}"
                                  >
                                </div>
                              {%- endif -%}
                            </div>

                            <div class="line-item__meta">
                              {%- if settings.show_vendor and gift_wrap_product.handle != line_item.product.handle -%}
                                {%- assign vendor_handle = line_item.product.vendor | handle -%}
                                {%- assign collection_for_vendor = collections[vendor_handle] -%}

                                {%- unless collection_for_vendor.empty? -%}
                                  <a class="line-item__vendor link" href="{{ collection_for_vendor.url }}">
                                    {{- line_item.product.vendor -}}
                                  </a>
                                {%- else -%}
                                  <a
                                    class="line-item__vendor link"
                                    href="{{ line_item.product.vendor | url_for_vendor }}"
                                  >
                                    {{- line_item.product.vendor -}}
                                  </a>
                                {%- endunless -%}
                              {%- endif -%}

                              {%- if gift_wrap_product.handle == line_item.product.handle -%}
                                <span class="line-item__title text--strong">{{ line_item.title }}</span>
                              {%- else -%}
                                <a href="{{ line_item.url }}" class="line-item__title link text--strong">
                                  {{- line_item.title -}}
                                </a>
                              {%- endif -%}

                              {%- if line_item.selling_plan_allocation -%}
                                <p class="line-item__plan-allocation">
                                  {{ line_item.selling_plan_allocation.selling_plan.name }}
                                </p>
                              {%- endif -%}

                              {%- unless line_item.properties == blank -%}
                                <ul class="line-item__property-list" role="list">
                                  {%- for property in line_item.properties -%}
                                    {%- assign first_character_in_key = property.first | truncate: 1, '' -%}

                                    {%- if property.last == blank or first_character_in_key == '_' -%}
                                      {%- continue -%}
                                    {%- endif -%}

                                    <li class="line-item__property">{{ property.first }}: {{ property.last }}</li>
                                  {%- endfor -%}
                                </ul>
                              {%- endunless -%}

                              <div class="line-item__price-list">
                                {%- if line_item.original_price > line_item.final_price -%}
                                  {%- if line_item.final_price == 0 -%}
                                    <span class="line-item__price line-item__price--highlight">
                                      {{- 'cart.general.free' | t -}}
                                    </span>
                                  {%- else -%}
                                    <span class="line-item__price line-item__price--highlight">
                                      {{- line_item.final_price | money -}}
                                    </span>
                                  {%- endif -%}

                                  <span class="line-item__price line-item__price--compare">
                                    {{- line_item.original_price | money -}}
                                  </span>
                                {%- elsif line_item.variant.compare_at_price > line_item.variant.price -%}
                                  {%- if line_item.final_price == 0 -%}
                                    <span class="line-item__price line-item__price--highlight">
                                      {{- 'cart.general.free' | t -}}
                                    </span>
                                  {%- else -%}
                                    <span class="line-item__price line-item__price--highlight">
                                      {{- line_item.final_price | money -}}
                                    </span>
                                  {%- endif -%}

                                  <span class="line-item__price line-item__price--compare">
                                    {{- line_item.variant.compare_at_price | money -}}
                                  </span>
                                {%- else -%}
                                  {%- if line_item.final_price == 0 -%}
                                    <span class="line-item__price">{{ 'cart.general.free' | t }}</span>
                                  {%- else -%}
                                    <span class="line-item__price">{{ line_item.final_price | money }}</span>
                                  {%- endif -%}
                                {%- endif -%}
                              </div>

                              {%- if line_item.unit_price_measurement -%}
                                <div class="line-item__price-info">
                                  <div class="unit-price-measurement">
                                    <span class="unit-price-measurement__price">
                                      {{- line_item.unit_price | money -}}
                                    </span>
                                    <span class="unit-price-measurement__separator">/ </span>

                                    {%- if line_item.unit_price_measurement.reference_value != 1 -%}
                                      <span class="unit-price-measurement__reference-value">
                                        {{- line_item.unit_price_measurement.reference_value -}}
                                      </span>
                                    {%- endif -%}

                                    <span class="unit-price-measurement__reference-unit">
                                      {{- line_item.unit_price_measurement.reference_unit -}}
                                    </span>
                                  </div>
                                </div>
                              {%- endif -%}

                              {%- if line_item.line_level_discount_allocations != blank -%}
                                <ul class="line-item__discount-list" role="list">
                                  {%- for discount_allocation in line_item.line_level_discount_allocations -%}
                                    <li class="line-item__discount">
                                      {%- render 'icon', icon: 'sale' -%}
                                      {{ discount_allocation.discount_application.title }} (-
                                      {{- discount_allocation.amount | money -}}
                                      )
                                    </li>
                                  {%- endfor -%}
                                </ul>
                              {%- endif -%}

                              <div class="line-item__quantity hidden-tablet-and-up">
                                {%- comment -%}If the product has the tag "__gift", we remove the price{%- endcomment -%}

                                {%- unless line_item.product.tags contains '__gift' -%}
                                  <div
                                    class="quantity-selector"
                                    style="background: #efefef;box-shadow: 0 2px 5px -3px #0000005e; border: none;"
                                  >
                                    {%- assign allow_to_add_more = true -%}

                                    {%- if line_item.variant.inventory_management
                                      and line_item.variant.inventory_policy == 'deny'
                                      and line_item.quantity == line_item.variant.inventory_quantity
                                    -%}
                                      {%- assign allow_to_add_more = false -%}
                                    {%- endif -%}

                                    <button
                                      type="button"
                                      class="quantity-selector__button"
                                      data-action="decrease-quantity"
                                      data-href="{{ routes.cart_change_url }}?quantity={{ line_item.quantity | minus: 1 }}&line={{ forloop.index }}"
                                      data-quantity="{{ line_item.quantity | minus: 1 }}"
                                      data-line="{{ forloop.index }}"
                                      aria-label="{{ 'cart.items.decrease_quantity' | t }}"
                                      title="{{ 'cart.items.decrease_quantity' | t }}"
                                    >
                                      {% render 'icon', icon: 'minus' %}
                                    </button>
                                    <input
                                      aria-label="{{ 'product.form.quantity' | t }}"
                                      class="quantity-selector__value"
                                      inputmode="numeric"
                                      data-current-value="{{ line_item.quantity }}"
                                      data-line="{{ forloop.index }}"
                                      value="{{ line_item.quantity }}"
                                      size="{{ line_item.quantity | append: '' | size | at_least: 2 }}"
                                    >
                                    <button
                                      type="button"
                                      class="quantity-selector__button"
                                      data-action="increase-quantity"
                                      data-href="{{ routes.cart_change_url }}?quantity={{ line_item.quantity | plus: 1 }}&line={{ forloop.index }}"
                                      data-quantity="{{ line_item.quantity | plus: 1 }}"
                                      data-line="{{ forloop.index }}"
                                      {% if allow_to_add_more %}
                                        aria-label="{{ 'cart.items.increase_quantity' | t }}"
                                        title="{{ 'cart.items.increase_quantity' | t }}"
                                      {% else %}
                                        disabled="disabled" aria-label="{{ 'cart.items.no_more_stock' | t }}"
                                        data-tooltip="{{ 'cart.items.no_more_stock' | t }}"
                                        data-tooltip-position="bottom-left"
                                      {% endif %}
                                    >
                                      {% render 'icon', icon: 'plus' %}
                                    </button>
                                  </div>
                                {%- else -%}
                                  <span>{{ line_item.quantity }}</span>
                                {% endunless -%}

                                <a
                                  href="{{ routes.cart_change_url }}?quantity=0&line={{ forloop.index }}"
                                  data-action="decrease-quantity"
                                  data-quantity="0"
                                  data-line="{{ forloop.index }}"
                                  class="line-item__quantity-remove link"
                                >
                                  {{- 'cart.items.remove' | t -}}
                                </a>
                              </div>
                            </div>
                          </div>
                        </td>

                        <td class="line-item__quantity table__cell--center hidden-phone">
                          {%- comment -%}If the product has the tag "__gift", we remove the price{%- endcomment -%}

                          {%- unless line_item.product.tags contains '__gift' -%}
                            <div
                              class="quantity-selector"
                              style="background: #efefef;box-shadow: 0 2px 5px -3px #0000005e; border: none;"
                            >
                              {%- assign allow_to_add_more = true -%}

                              {%- if line_item.variant.inventory_management
                                and line_item.variant.inventory_policy == 'deny'
                                and line_item.quantity == line_item.variant.inventory_quantity
                              -%}
                                {%- assign allow_to_add_more = false -%}
                              {%- endif -%}

                              <button
                                type="button"
                                class="quantity-selector__button"
                                data-action="decrease-quantity"
                                data-href="{{ routes.cart_change_url }}?quantity={{ line_item.quantity | minus: 1 }}&line={{ forloop.index }}"
                                data-quantity="{{ line_item.quantity | minus: 1 }}"
                                data-line="{{ forloop.index }}"
                                aria-label="{{ 'cart.items.decrease_quantity' | t }}"
                                title="{{ 'cart.items.decrease_quantity' | t }}"
                              >
                                {% render 'icon', icon: 'minus' %}
                              </button>
                              <input
                                aria-label="{{ 'product.form.quantity' | t }}"
                                class="quantity-selector__value"
                                inputmode="numeric"
                                data-current-value="{{ line_item.quantity }}"
                                data-line="{{ forloop.index }}"
                                value="{{ line_item.quantity }}"
                                size="{{ line_item.quantity | append: '' | size | at_least: 2 }}"
                              >
                              <button
                                type="button"
                                class="quantity-selector__button"
                                data-action="increase-quantity"
                                data-href="{{ routes.cart_change_url }}?quantity={{ line_item.quantity | plus: 1 }}&line={{ forloop.index }}"
                                data-quantity="{{ line_item.quantity | plus: 1 }}"
                                data-line="{{ forloop.index }}"
                                {% if allow_to_add_more %}
                                  aria-label="{{ 'cart.items.increase_quantity' | t }}"
                                  title="{{ 'cart.items.increase_quantity' | t }}"
                                {% else %}
                                  disabled="disabled" aria-label="{{ 'cart.items.no_more_stock' | t }}"
                                  data-tooltip="{{ 'cart.items.no_more_stock' | t }}"
                                  data-tooltip-position="bottom-left"
                                {% endif %}
                              >
                                {% render 'icon', icon: 'plus' %}
                              </button>
                            </div>
                          {%- else -%}
                            <span>{{ line_item.quantity }}</span>
                          {%- endunless -%}

                          <a
                            href="{{ routes.cart_change_url }}?quantity=0&line={{ forloop.index }}"
                            data-action="decrease-quantity"
                            data-quantity="0"
                            data-line="{{ forloop.index }}"
                            class="line-item__quantity-remove link"
                          >
                            {{- 'cart.items.remove' | t -}}
                          </a>
                        </td>

                        <td
                          class="line-item__line-price table__cell--right hidden-phone"
                          style="min-width:150px !important"
                        >
                          {%- if line_item.final_line_price == 0 -%}
                            {{- 'cart.general.free' | t -}}
                          {%- else -%}
                            <span>{{ line_item.final_line_price | money }}</span>
                          {%- endif -%}
                        </td>
                      </tr>
                    {%- endfor -%}
                  </tbody>
                </table>
              </div>
            </div>

            {%- comment -%}
              --------------------------------------------------------------------------------------
              GIFT WRAP
              --------------------------------------------------------------------------------------
            {%- endcomment -%}

            {%- assign gift_wrap_product = all_products[section.settings.gift_wrap_product] -%}

            {%- unless gift_wrap_product.empty? or gift_wrap_product.available == false -%}
              {%- comment -%}We also have to do another check to make sure the gift wrap product is not already in the cart{%- endcomment -%}

              {%- assign gift_wrap_in_cart = false -%}

              {%- for line_item in cart.items -%}
                {%- if line_item.product_id == gift_wrap_product.id -%}
                  {%- assign gift_wrap_in_cart = true -%}
                  {%- break -%}
                {%- endif -%}
              {%- endfor -%}

              {%- unless gift_wrap_in_cart -%}
                <div class="card">
                  <div class="gift-wrap">
                    <div class="gift-wrap__left">
                      <span class="gift-wrap__icon">{% render 'icon', icon: 'bi-gift-wrap' %}</span>

                      <p class="gift-wrap__text">
                        <span class="text--strong">{{ section.settings.gift_wrap_text | escape }}</span>

                        {%- if gift_wrap_product.price == 0 -%}
                          <span>{{ 'cart.general.free' | t }}</span>
                        {%- else -%}
                          {%- capture gift_wrap_product_price -%}<span>{{ gift_wrap_product.price | money }}</span>{%- endcapture -%}
                          <span>{{ 'cart.gift_wrap.price_html' | t: price: gift_wrap_product_price }}</span>
                        {%- endif -%}
                      </p>
                    </div>

                    {%- form 'product', gift_wrap_product, class: 'gift-wrap__form' -%}
                      <input type="hidden" name="quantity" value="1">
                      <input
                        type="hidden"
                        name="id"
                        data-sku="{{ gift_wrap_product.first_available_variant.sku }}"
                        value="{{ gift_wrap_product.first_available_variant.id }}"
                      >

                      <button type="submit" class="button button--secondary" data-action="add-to-cart">
                        {{ section.settings.gift_wrap_button | escape }}
                      </button>
                    {%- endform -%}
                  </div>
                </div>
              {%- endunless -%}
            {%- endunless -%}

            {%- comment -%}
              --------------------------------------------------------------------------------------
              SHIPPING ESTIMATOR
              --------------------------------------------------------------------------------------
            {%- endcomment -%}

            {%- if section.settings.show_shipping_estimator -%}
              <div class="card">
                <div class="estimate-shipping">
                  <button
                    type="button"
                    class="estimate-shipping__toggle"
                    data-action="toggle-collapsible"
                    data-collapsible-force-overflow
                    aria-expanded="false"
                    aria-controls="shipping-estimator"
                  >
                    <span class="estimate-shipping__icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        style="fill: none;width: 41px;height: 32px;margin-left: -9px;margin-top: -2px;margin-right: 12px;"
                      >
                        <path stroke=" var(--header-accent-color)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 16.016c1.245.529 2 1.223 2 1.984 0 1.657-3.582 3-8 3s-8-1.343-8-3c0-.76.755-1.456 2-1.984"/><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8.444C17 11.537 12 17 12 17s-5-5.463-5-8.556C7 5.352 9.239 3 12 3s5 2.352 5 5.444z"/><circle cx="12" cy="8" r="1" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
                      </svg>
                    </span>
                    <span class="estimate-shipping__text">{{ 'cart.shipping_estimator.title' | t }}</span>
                    <span class="estimate-shipping__arrow">{% render 'icon', icon: 'arrow-bottom' %}</span>
                  </button>

                  <div id="shipping-estimator" class="estimate-shipping__collapsible collapsible">
                    {% render 'fretecart' %}
                  </div>
                </div>
              </div>
            {%- endif -%}

            {%- comment -%}
              --------------------------------------------------------------------------------------
              RECAP
              --------------------------------------------------------------------------------------
            {%- endcomment -%}

            <form
              class="cart-recap"
              method="post"
              action="{{ routes.cart_url }}"
              novalidate="novalidate"
              data-item-count="{{ cart.item_count }}"
            >
              <div class="cart-recap__scroller">
                <div class="card">
                  <div class="card__section">
                    {%- if cart.cart_level_discount_applications != blank -%}
                      {%- for discount_application in cart.cart_level_discount_applications -%}
                        <div class="cart-recap__price-line cart-recap__price-line--highlight text--pull">
                          <span class="cart-recap__price-line-label">{{ discount_application.title }}</span>
                          <span class="cart-recap__price-line-price"
                            >-{{ discount_application.total_allocated_amount | money -}}
                          </span>
                        </div>
                      {%- endfor -%}
                    {%- endif -%}

                    <div class="cart-recap__price-line text--pull">
                      <span class="cart-recap__price-line-label">{{ 'cart.general.total' | t }}</span>
                      <span class="cart-recap__price-line-price"
                        ><strong>{{ cart.total_price | money }}</strong></span
                      >
                    </div>

                    {%- comment -%}
                      To calculate the total discount, we take into account the Shopify Script (for Plus merchants), but we also add the compare at price as
                      well as potential automatic discounts at cart level
                    {%- endcomment -%}

                    {%- assign total_discount = 0 -%}

                    {%- for line_item in cart.items -%}
                      {%- if line_item.final_line_price < line_item.original_line_price -%}
                        {%- assign total_discount = total_discount | plus: line_item.total_discount -%}
                      {%- elsif line_item.variant.compare_at_price > line_item.variant.price -%}
                        {%- assign line_discount = line_item.variant.compare_at_price
                          | minus: line_item.variant.price
                          | times: line_item.quantity
                        -%}
                        {%- assign total_discount = total_discount | plus: line_discount -%}
                      {%- endif -%}
                    {%- endfor -%}

                    {%- for discount_application in cart.cart_level_discount_applications -%}
                      {%- assign total_discount = total_discount | plus: discount_application.total_allocated_amount -%}
                    {%- endfor -%}

                    {%- if total_discount > 0 -%}
                      {%- capture amount_saved -%}<span>{{ total_discount | money }}</span>{%- endcapture -%}
                      <span class="cart-recap__amount-saved">
                        {{- 'cart.general.amount_saved_html' | t: amount_saved: amount_saved -}}
                      </span>
                    {%- endif -%}

                    {%- if section.settings.enable_order_notes -%}
                      <div class="cart-recap__note">
                        <button
                          type="button"
                          class="cart-recap__note-button"
                          data-action="toggle-collapsible"
                          data-collapsible-force-overflow
                          aria-controls="order-note"
                          aria-expanded="false"
                        >
                          {{- 'cart.general.note_title' | t -}}
                          <span>
                            <span class="cart-recap__note-edit {% if cart.note != blank %}is-visible{% endif %}">
                              {{- 'cart.general.edit_note' | t -}}
                            </span>
                            {%- render 'icon', icon: 'arrow-bottom' -%}
                          </span>
                        </button>

                        <div id="order-note" class="collapsible" aria-hidden="true">
                          <div class="cart-recap__note-inner">
                            <textarea
                              name="note"
                              class="form__field form__field--textarea"
                              rows="3"
                              autofocus
                            >{{ cart.note }}</textarea>
                            <button
                              type="button"
                              class="form__submit form__submit--tight button button--secondary"
                              data-action="save-note"
                            >
                              {{ 'cart.general.save_note' | t }}
                            </button>
                          </div>
                        </div>
                      </div>
                    {%- endif -%}

                    <input type="hidden" name="attributes[collection_products_per_page]" value="">
                    <input type="hidden" name="attributes[collection_layout]" value="">

                    {%- if settings.cart_show_free_shipping_threshold -%}
                      {%- assign threshold_in_cents = settings.cart_free_shipping_threshold | times: 100 -%}

                      {%- if cart.total_price >= threshold_in_cents -%}
                        <p class="page__description">{{ 'cart.general.free_shipping' | t }}</p>
                      {%- else -%}
                        {%- capture remaining_amount -%}<span>{{ cart.total_price | minus: threshold_in_cents | abs | money }}</span>{%- endcapture -%}
                        <p class="page__description">
                          {{ 'cart.general.free_shipping_remaining_html' | t: remaining_amount: remaining_amount }}
                        </p>
                      {%- endif -%}
                    {%- endif -%}
                    <div>
                      <button
                        type="submit"
                        name="checkout"
                        class="page__button-action button button--primary-cart metade"
                      >
                        <i class="fas fa-check-square"></i> {{ 'cart.general.checkout' | t }}
                      </button>
                      <a class="metade" href="/collections"
                        ><span
                          style="font-size: 18px;border-radius: var(--borda-bot-qnt) !important;"
                          class="page__button-action button button--primary botaocontinuar"
                          ><i class="fas fa-undo-alt"></i> CONTINUAR COMPRANDO</span
                        ></a
                      >
                    </div>
                    <br>
                    {%- if section.settings.show_payment_icons -%}
                      <style>
                        @media (max-width: 768px) {
                          .cartoes {
                            max-height: auto;
                            width: var(--bandeiras-w-mobile2);
                            margin-top: 0px;
                            margin-bottom: 5px;
                          }
                        }

                        @media (min-width: 769px) {
                          .cartoes {
                            max-height: auto;
                            width: var(--bandeiras-w-desktop2);
                            margin-top: 0px;
                            margin-bottom: 5px;
                          }
                        }
                      </style>

                      <div class="cart-recap__secure-payment" style="margin-top: 18px;">
                        <p class="cart-recap__secure-payment-title">
                          {% render 'icon', icon: 'lock-2' %}
                          {{ 'cart.general.secure_payments' | t }}
                        </p>

                        <div class="cart-recap__secure-payment-list payment-list payment-list--centered">
                          <center style="">
                            <div class="payment-list2">
                              {% if settings.show_bandeiras1 %}
                                {% if settings.show_visa_p -%}
                                  <img class="cartoes" src="{{ 'Visa.svg' | asset_url }}" alt="Visa">
                                {%- endif %}
                                {% if settings.show_master_p -%}
                                  <img class="cartoes" src="{{ 'mastercard.svg' | asset_url }}" alt="Mastercard">
                                {%- endif %}
                                {% if settings.show_hiper_p -%}
                                  <img class="cartoes" src="{{ 'hipercard.svg' | asset_url }}" alt="Hipercard">
                                {%- endif %}
                                {% if settings.show_elo_p -%}
                                  <img class="cartoes" src="{{ 'Elo.svg' | asset_url }}" alt="Elo">
                                {%- endif %}
                                {% if settings.show_amex_p -%}
                                  <img class="cartoes" src="{{ 'Amex.svg' | asset_url }}" alt="Amex">
                                {%- endif %}
                                {% if settings.show_discover_p -%}
                                  <img class="cartoes" src="{{ 'Discover.svg' | asset_url }}" alt="Discover">
                                {%- endif %}
                                {% if settings.show_pix_p -%}
                                  <img class="cartoes" src="{{ 'Pix.svg' | asset_url }}" alt="Pix">
                                {%- endif %}
                                {% if settings.show_boleto_p -%}
                                  <img class="cartoes" src="{{ 'Boleto.svg' | asset_url }}" alt="Pix">
                                {%- endif %}
                              {% endif %}

                              {% if settings.show_bandeiras2 %}
                                {% if settings.show_visa_p -%}
                                  <img class="cartoes" src="{{ 'Visa2.svg' | asset_url }}" alt="Visa">
                                {%- endif %}
                                {% if settings.show_master_p -%}
                                  <img class="cartoes" src="{{ 'Master2.svg' | asset_url }}" alt="Mastercard">
                                {%- endif %}
                                {% if settings.show_hiper_p -%}
                                  <img class="cartoes" src="{{ 'Hipercard2.svg' | asset_url }}" alt="Hipercard">
                                {%- endif %}
                                {% if settings.show_elo_p -%}
                                  <img class="cartoes" src="{{ 'Elo2.svg' | asset_url }}" alt="Elo">
                                {%- endif %}
                                {% if settings.show_amex_p -%}
                                  <img class="cartoes" src="{{ 'Amex2.svg' | asset_url }}" alt="Amex">
                                {%- endif %}
                                {% if settings.show_pix_p -%}
                                  <img class="cartoes" src="{{ 'Pix2.svg' | asset_url }}" alt="Pix">
                                {%- endif %}
                                {% if settings.show_boleto_p -%}
                                  <img class="cartoes" src="{{ 'Boleto2.svg' | asset_url }}" alt="Pix">
                                {%- endif %}
                              {% endif %}
                            </div>
                          </center>
                        </div>
                      </div>
                    {%- endif -%}
                  </div>
                </div>
              </div>
            </form>
          </div>

          {%- comment -%}
            --------------------------------------------------------------------------------------
            UPSELL
            --------------------------------------------------------------------------------------
          {%- endcomment -%}

          {%- assign upsell_collection = collections[section.settings.upsell_collection] -%}

          {%- if section.blocks.size > 0 or upsell_collection != empty -%}
            <div class="container">
              {%- if section.blocks.size > 0 -%}
                <div class="section">
                  <header class="section__header">
                    <h2 class="section__title heading h3">{{ section.settings.trust_heading | escape }}</h2>
                  </header>

                  <div class="text-with-icons text-with-icons--boxed">
                    {%- for block in section.blocks -%}
                      <div class="text-with-icons__item" {{ block.shopify_attributes }}>
                        <div class="text-with-icons__icon-wrapper">
                          {%- if block.settings.custom_icon != blank -%}
                            <img
                              src="{{ block.settings.custom_icon | img_url: '60x' }}"
                              alt="{{ block.settings.custom_icon.alt | escape }}"
                            >
                          {%- else -%}
                            {%- render 'icon', icon: block.settings.icon, stroke_width: 1.5 -%}
                          {%- endif -%}
                        </div>

                        {%- if block.settings.title != blank or block.settings.content != blank -%}
                          <div class="text-with-icons__content-wrapper">
                            {%- if block.settings.title != blank -%}
                              <p class="text-with-icons__title text--strong">{{ block.settings.title | escape }}</p>
                            {%- endif -%}

                            {%- if block.settings.content != blank -%}
                              <div class="text-with-icons__content rte">
                                {{ block.settings.content }}
                              </div>
                            {%- endif -%}
                          </div>
                        {%- endif -%}
                      </div>
                    {%- endfor -%}
                  </div>
                </div>
              {%- endif -%}

              {%- if upsell_collection != empty -%}
                {%- comment -%}We iterate through all the products, by making sure to remove those that are already in the cart{%- endcomment -%}

                {%- capture upsell_products -%}
                  {%- assign upsell_products_count = 0 -%}

                  {%- for product in upsell_collection.products -%}
                    {%- unless product.available -%}
                      {%- continue -%}
                    {%- endunless -%}

                    {%- assign include_product = true -%}

                    {%- for line_item in cart.items -%}
                      {%- if line_item.product_id == product.id -%}
                        {%- assign include_product = false -%}
                        {%- break -%}
                      {%- endif -%}
                    {%- endfor -%}

                    {%- if include_product -%}
                      {%- render 'product-item', product: product, show_add_to_cart: true, grid_classes: '1/3--lap 1/3--desk 1/4--wide' -%}

                      {%- comment -%}Check how much products we have shown and limit{%- endcomment -%}
                      {%- assign upsell_products_count = upsell_products_count | plus: 1 -%}

                      {%- if upsell_products_count >= section.settings.upsell_products_count -%}
                        {%- break -%}
                      {%- endif -%}
                    {%- endif -%}
                  {%- endfor -%}
                {%- endcapture -%}

                {%- if upsell_products != blank -%}
                  {%- capture section_settings -%}
                  {
                    "stackable": false,
                    "layout": "vertical"
                  }
                  {%- endcapture -%}

                  <div
                    class="section"
                    data-section-id="{{ section.id }}-upsell"
                    data-section-type="featured-collection"
                    data-section-settings="{{ section_settings }}"
                  >
                    <header class="section__header">
                      <h2 class="section__title heading h3">{{ section.settings.upsell_heading | escape }}</h2>
                    </header>

                    <div class="scroller">
                      <div class="scroller__inner">
                        <div class="product-list product-list--vertical product-list--scrollable">
                          {{ upsell_products }}
                        </div>
                      </div>
                    </div>
                  </div>

                  {%- comment -%}
                    --------------------------------------------------------------------------------------
                    QUICK VIEW CONTAINER
                    --------------------------------------------------------------------------------------
                  {%- endcomment -%}

                  <div id="modal-quick-view-{{ section.id }}" class="modal" aria-hidden="true">
                    <div class="modal__dialog modal__dialog--stretch" role="dialog">
                      <div class="modal__loader">
                        {%- render 'icon', icon: 'search-loader' -%}
                      </div>

                      <div class="modal__inner"></div>
                    </div>
                  </div>
                {%- endif -%}
              {%- endif -%}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  {%- endif -%}
</section>

{% schema %}
{
  "name": "Página do Carrinho",
  "max_blocks": 3,
  "settings": [
    {
      "type": "paragraph",
      "content": "Essas configurações são aplicáveis apenas quando o carrinho contém pelo menos um produto."
    },
    {
      "type": "checkbox",
      "id": "enable_order_notes",
      "label": "Habilitar observações do pedido",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_payment_icons",
      "label": "Mostrar ícones de pagamento",
      "info": "As bandeiras mostradas são as mesmas mostradas na página de produto, portanto habilite ou desabilite por lá (configurações > Alterações Pagina do Produto) as bandeiras a serem mostradas.Altere a largura das bandeiras em configurações > Alterações Carrinho",
      "default": true
    },
    {
      "type": "header",
      "content": "Embrulho para presente"
    },
    {
      "type": "paragraph",
      "content": "O embrulho para presente precisa ser configurado como um produto. [Leia mais](https://support.maestrooo.com/article/190-cart-set-up-a-gift-wrap-product)"
    },
    {
      "type": "product",
      "id": "gift_wrap_product",
      "label": "Produto"
    },
    {
      "type": "text",
      "id": "gift_wrap_text",
      "label": "Texto",
      "default": "Você deseja um embrulho para presente?"
    },
    {
      "type": "text",
      "id": "gift_wrap_button",
      "label": "Botão",
      "default": "Adicionar embrulho para presente"
    },
    {
      "type": "header",
      "content": "Estimativa de frete"
    },
    {
      "type": "checkbox",
      "id": "show_shipping_estimator",
      "label": "Mostrar calculadora de Frete Vision",
      "default": true
    },

    {
      "type": "header",
      "content": "Upsell"
    },
    {
      "type": "paragraph",
      "content": "Mostrar produtos adicionais para incentivar os clientes a comprar mais."
    },
    {
      "type": "text",
      "id": "upsell_heading",
      "label": "Título",
      "default": "Complete seu carrinho"
    },
    {
      "type": "collection",
      "id": "upsell_collection",
      "label": "Coleção",
      "info": "Produtos já presentes no carrinho ou esgotados serão ocultados."
    },
    {
      "type": "range",
      "id": "upsell_products_count",
      "label": "Produtos para mostrar",
      "min": 4,
      "max": 12,
      "step": 4,
      "default": 4
    }
  ],
  "blocks": [
    {
      "name": "Texto de Confiança",
      "type": "trust",
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": "Ícone",
          "options": [
            {
              "value": "bi-add-to-cart",
              "label": "Adicionar ao carrinho",
              "group": "Loja"
            },
            {
              "value": "bi-gift-wrap",
              "label": "Embrulho para presente",
              "group": "Loja"
            },
            {
              "value": "bi-gift-box",
              "label": "Caixa de presente",
              "group": "Loja"
            },
            {
              "value": "bi-heart",
              "label": "Coração",
              "group": "Loja"
            },
            {
              "value": "bi-ecology",
              "label": "Ecologia",
              "group": "Loja"
            },
            {
              "value": "bi-plant",
              "label": "Planta",
              "group": "Loja"
            },
            {
              "value": "bi-shop",
              "label": "Loja",
              "group": "Loja"
            },
            {
              "value": "bi-shop-pin",
              "label": "Loja com alfinete",
              "group": "Loja"
            },
            {
              "value": "bi-alert",
              "label": "Alerta",
              "group": "Comunicação"
            },
            {
              "value": "bi-chat",
              "label": "Chat",
              "group": "Comunicação"
            },
            {
              "value": "bi-comment",
              "label": "Comentário",
              "group": "Comunicação"
            },
            {
              "value": "bi-customer-support",
              "label": "Suporte ao cliente",
              "group": "Comunicação"
            },
            {
              "value": "bi-email",
              "label": "E-mail",
              "group": "Comunicação"
            },
            {
              "value": "bi-network",
              "label": "Rede",
              "group": "Comunicação"
            },
            {
              "value": "bi-newsletter",
              "label": "Boletim informativo",
              "group": "Comunicação"
            },
            {
              "value": "bi-love",
              "label": "Amor",
              "group": "Comunicação"
            },
            {
              "value": "bi-phone",
              "label": "Telefone",
              "group": "Comunicação"
            },
            {
              "value": "bi-share",
              "label": "Compartilhar",
              "group": "Comunicação"
            },
            {
              "value": "bi-delivery",
              "label": "Entrega",
              "group": "Entrega"
            },
            {
              "value": "bi-fast-delivery",
              "label": "Entrega rápida",
              "group": "Entrega"
            },
            {
              "value": "bi-returns",
              "label": "Devoluções",
              "group": "Entrega"
            },
            {
              "value": "bi-time",
              "label": "Tempo",
              "group": "Entrega"
            },
            {
              "value": "bi-secure-payment",
              "label": "Pagamento seguro",
              "group": "Segurança"
            },
            {
              "value": "bi-mobile-payment",
              "label": "Pagamento móvel",
              "group": "Segurança"
            },
            {
              "value": "bi-credit-card",
              "label": "Cartão de crédito",
              "group": "Segurança"
            },
            {
              "value": "bi-shield",
              "label": "Escudo",
              "group": "Segurança"
            }
          ],
          "default": "bi-customer-support"
        },
        {
          "type": "image_picker",
          "id": "custom_icon",
          "label": "Ícone personalizado",
          "info": "Recomendado .png de 60 x 60 pixels com transparência"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Título",
          "default": "Seu título"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Conteúdo",
          "default": "<p>Conteúdo breve sobre sua loja</p>"
        }
      ]
    }
  ]
}
{% endschema %}

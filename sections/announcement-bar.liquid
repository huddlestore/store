{%- if section.settings.show_announcement -%}
  <style>
    :root {
         --font-anuncio: {{ section.settings.anuncio_font_size }}px;
      --cor-icons-anun: {{ section.settings.cor_icons_anun}};
    }

    p.announcement-bar__content.announcement-bar__content--left {
        font-size: var(--font-anuncio) !important;
    }

      div#shopify-section-announcement-bar {
        font-size: var(--font-anuncio) !important;
    }

    p.announcement-bar__content.announcement-bar__content--right.mobhide {
        font-size: var(--font-anuncio) !important;
    }
  </style>

  {%- if section.settings.anuncio_padrao -%}
    {%- capture section_settings -%}
  {
    "showNewsletter": {{ section.settings.show_newsletter | json }}
  }
  {%- endcapture -%}

    <section
      data-section-id="{{ section.id }}"
      data-section-type="announcement-bar"
      data-section-settings="{{ section_settings }}"
    >
      {%- if section.settings.show_newsletter -%}
        <div id="announcement-bar-newsletter" class="announcement-bar__newsletter hidden-phone" aria-hidden="true">
          <div class="container">
            <div class="announcement-bar__close-container">
              <button class="announcement-bar__close" data-action="toggle-newsletter">
                <span class="visually-hidden">{{ 'general.accessibility.close' | t }}</span>
                {%- render 'icon', icon: 'close' -%}
              </button>
            </div>
          </div>

          <div class="container container--extra-narrow">
            <div class="announcement-bar__newsletter-inner">
              {%- if section.settings.newsletter_title != blank -%}
                <h2 class="heading h1">{{ section.settings.newsletter_title | escape }}</h2>
              {%- endif -%}

              {%- if section.settings.newsletter_content != blank -%}
                <div class="rte">
                  {{ section.settings.newsletter_content }}
                </div>
              {%- endif -%}

              {%- assign newsletter_id = 'newsletter-' | append: section.id -%}

              <div class="newsletter">
                {%- form 'customer', id: newsletter_id, class: 'form newsletter__form' -%}
                  {%- if form.posted_successfully? -%}
                    <p class="alert alert--success alert--center">{{ 'home_page.newsletter.success' | t }}</p>
                    {%- if form.context == 'announcement-bar' -%}
                      {%- assign open_announcement = true -%}
                    {%- endif -%}
                  {%- else -%}
                    {%- if form.errors -%}
                      <p class="alert alert--error">{{ form.errors.messages.email }}</p>
                    {%- endif -%}

                    <input type="hidden" name="contact[tags]" value="newsletter">
                    <input type="hidden" name="contact[context]" value="announcement-bar">

                    <div class="form__input-row">
                      <div class="form__input-wrapper form__input-wrapper--labelled">
                        <input
                          type="email"
                          id="announcement[contact][email]"
                          name="contact[email]"
                          class="form__field form__field--text"
                          autofocus
                          required
                        >
                        <label for="announcement[contact][email]" class="form__floating-label">
                          {{- 'home_page.newsletter.input' | t -}}
                        </label>
                      </div>

                      <button type="submit" class="form__submit button button--primary">
                        {{ 'home_page.newsletter.submit' | t }}
                      </button>
                    </div>
                  {%- endif -%}
                {%- endform -%}
              </div>
            </div>
          </div>
        </div>
      {%- endif -%}

      <div class="announcement-bar">
        <div class="container">
          <div class="announcement-bar__inner" style="display: block !important;">
            {%- if section.settings.link != blank -%}
              <a
                href="{{ section.settings.link }}"
                class="announcement-bar__content announcement-bar__content--{{ section.settings.text_position }}"
              >
                {{- section.settings.text | escape -}}
              </a>
            {%- else -%}
              <p class="announcement-bar__content announcement-bar__content--{{ section.settings.text_position }}">
                {{ section.settings.text | escape }}
              </p>
            {%- endif -%}

            {%- if section.settings.show_newsletter -%}
              <button
                type="button"
                class="announcement-bar__button hidden-phone"
                data-action="toggle-newsletter"
                aria-expanded="false"
                aria-controls="announcement-bar-newsletter"
              >
                {%- render 'icon', icon: 'newsletter' -%}
                {{- section.settings.newsletter_button | escape -}}
              </button>
            {%- endif -%}
          </div>
        </div>
      </div>
    </section>

    <style>
      .announcement-bar {
        background: var(--anuncio-background);
        color: {{ section.settings.text_color }};
      }
    </style>

    <script>
      {%- if section.settings.show_newsletter -%}
        document.documentElement.style.setProperty('--announcement-bar-button-width', document.querySelector('.announcement-bar__button').clientWidth + 'px');
      {%- else -%}
        document.documentElement.style.removeProperty('--announcement-bar-button-width');
      {%- endif -%}

      document.documentElement.style.setProperty('--announcement-bar-height', document.getElementById('shopify-section-{{ section.id }}').clientHeight + 'px');
    </script>
  {%- endif -%}
{%- endif -%}

{%- if section.settings.show_announcement -%}
  {%- if section.settings.anuncio_icons -%}
    {%- capture section_settings -%}
  {
    "showNewsletter": {{ section.settings.show_newsletter | json }}
  }
  {%- endcapture -%}

    <section
      data-section-id="{{ section.id }}"
      data-section-type="announcement-bar"
      data-section-settings="{{ section_settings }}"
    >
      {%- if section.settings.show_newsletter -%}
        <div id="announcement-bar-newsletter" class="announcement-bar__newsletter hidden-phone" aria-hidden="true">
          <div class="container">
            <div class="announcement-bar__close-container">
              <button class="announcement-bar__close" data-action="toggle-newsletter">
                <span class="visually-hidden">{{ 'general.accessibility.close' | t }}</span>
                {%- render 'icon', icon: 'close' -%}
              </button>
            </div>
          </div>

          <div class="container container--extra-narrow">
            <div class="announcement-bar__newsletter-inner">
              {%- if section.settings.newsletter_title != blank -%}
                <h2 class="heading h1">{{ section.settings.newsletter_title | escape }}</h2>
              {%- endif -%}

              {%- if section.settings.newsletter_content != blank -%}
                <div class="rte">
                  {{ section.settings.newsletter_content }}
                </div>
              {%- endif -%}

              {%- assign newsletter_id = 'newsletter-' | append: section.id -%}

              <div class="newsletter">
                {%- form 'customer', id: newsletter_id, class: 'form newsletter__form' -%}
                  {%- if form.posted_successfully? -%}
                    <p class="alert alert--success alert--center">{{ 'home_page.newsletter.success' | t }}</p>
                    {%- if form.context == 'announcement-bar' -%}
                      {%- assign open_announcement = true -%}
                    {%- endif -%}
                  {%- else -%}
                    {%- if form.errors -%}
                      <p class="alert alert--error">{{ form.errors.messages.email }}</p>
                    {%- endif -%}

                    <input type="hidden" name="contact[tags]" value="newsletter">
                    <input type="hidden" name="contact[context]" value="announcement-bar">

                    <div class="form__input-row">
                      <div class="form__input-wrapper form__input-wrapper--labelled">
                        <input
                          type="email"
                          id="announcement[contact][email]"
                          name="contact[email]"
                          class="form__field form__field--text"
                          autofocus
                          required
                        >
                        <label for="announcement[contact][email]" class="form__floating-label">
                          {{- 'home_page.newsletter.input' | t -}}
                        </label>
                      </div>

                      <button type="submit" class="form__submit button button--primary">
                        {{ 'home_page.newsletter.submit' | t }}
                      </button>
                    </div>
                  {%- endif -%}
                {%- endform -%}
              </div>
            </div>
          </div>
        </div>
      {%- endif -%}

      <div class="announcement-bar">
        <div class="container">
          <div class="announcement-bar__inner">
            <div class="announcement-bar__inner">
              <p class="announcement-bar__content announcement-bar__content--left">
                <svg
                  class="announcesvg"
                  viewBox="0 0 32 32"
                  xml:space="preserve"
                  xmlns="http://www.w3.org/2000/svg"
                  enable-background="new 0 0 32 32"
                >
                  <path d="M31.5 7.84a1.535 1.535 0 0 0-.996-1.412l-14-5a1.515 1.515 0 0 0-1.008 0l-14 5A1.535 1.535 0 0 0 .5 7.84v16.322c.007.622.408 1.2.996 1.411l14 5c.32.112.688.114 1.008 0l14-5a1.55 1.55 0 0 0 .86-.793c.085-.196.126-.405.136-.618V7.841zm-28 2.13 11 3.928v13.135l-11-3.93V9.97zm14 3.928 11-3.928v13.134l-11 3.929V13.898zM16 4.434l9.54 3.407L16 11.248 6.46 7.841 16 4.434z" fill="var(--cor-icons-anun)" class="fill-000000">
                  </path>
                </svg>
                {{ section.settings.anuncio_icons_text1 }}
              </p>

              <p class="announcement-bar__content announcement-bar__content--right mobhide">
                <svg
                  class="announcesvg"
                  viewBox="0 0 1024 1024"
                  xml:space="preserve"
                  xmlns="http://www.w3.org/2000/svg"
                  enable-background="new 0 0 1024 1024"
                >
                  <path d="M639.6 387.4H856.4c32.4 0 60-27.5 60-60V110.6c0-15.4-6.7-31.5-17.6-42.4-10.4-10.4-27.5-18.2-42.4-17.6-15.5.7-31.6 5.8-42.4 17.6-10.8 11.7-17.6 26.2-17.6 42.4V327.4l60-60H639.6c-15.4 0-31.5 6.7-42.4 17.6-10.4 10.4-18.2 27.5-17.6 42.4.7 15.5 5.8 31.6 17.6 42.4 11.7 10.8 26.2 17.6 42.4 17.6z" fill="var(--cor-icons-anun)" class="fill-000000"></path><path d="M841.5 555.8c-4.9 32.2-13.7 63.6-26.3 93.7 2-4.8 4-9.6 6-14.3-13.1 31-30.2 60.1-50.7 86.8 3.1-4 6.3-8.1 9.4-12.1-20.5 26.4-44.2 50.2-70.6 70.7 4-3.1 8.1-6.3 12.1-9.4-27 20.8-56.5 38.1-88 51.4 4.8-2 9.6-4 14.3-6-31.8 13.3-65.1 22.3-99.3 27 5.3-.7 10.6-1.4 16-2.1-34.9 4.6-70.3 4.6-105.2-.1 5.3.7 10.6 1.4 16 2.1-33.9-4.6-67.1-13.7-98.7-26.9 4.8 2 9.6 4 14.3 6-31.2-13.2-60.6-30.3-87.5-51 4 3.1 8.1 6.3 12.1 9.4-26.6-20.6-50.5-44.5-71.1-71.2 3.1 4 6.3 8.1 9.4 12.1-20.4-26.5-37.4-55.5-50.5-86.3 2 4.8 4 9.6 6 14.3-13.5-32-22.7-65.5-27.4-99.9.7 5.3 1.4 10.6 2.1 16-4.7-35-4.7-70.5 0-105.6-.7 5.3-1.4 10.6-2.1 16 4.7-34.4 13.9-68 27.4-99.9-2 4.8-4 9.6-6 14.3 13.1-30.8 30.1-59.8 50.5-86.3-3.1 4-6.3 8.1-9.4 12.1 20.6-26.6 44.5-50.6 71.1-71.2-4 3.1-8.1 6.3-12.1 9.4 26.9-20.7 56.3-37.9 87.5-51.1-4.8 2-9.6 4-14.3 6 31.6-13.2 64.8-22.2 98.7-26.9-5.3.7-10.6 1.4-16 2.1 35.1-4.7 70.7-4.7 105.8 0-5.3-.7-10.6-1.4-16-2.1 34.1 4.7 67.3 13.8 99.1 27-4.8-2-9.6-4-14.3-6 30.9 13.1 60.1 30.1 86.7 50.5-4-3.1-8.1-6.3-12.1-9.4 26.8 20.7 50.8 44.7 71.5 71.4-3.1-4-6.3-8.1-9.4-12.1 12.8 16.7 24.3 34.3 34.3 52.8 7.1 13 21.8 23.7 35.9 27.6 14.4 4 33.5 2.2 46.2-6 12.8-8.3 24.1-20.6 27.6-35.9 3.7-16 1.9-31.6-6-46.2-40.5-74.7-104-138.5-178.8-179.3-38-20.7-79.6-36.7-122.1-45.5-43.1-8.9-87.8-12.6-131.7-8.5-41 3.8-81.5 11.6-120 26.4-37.5 14.4-73.2 32.2-105.6 56-32.1 23.6-61.7 49.8-86.6 81-25 31.3-46.9 64.3-62.9 101.2-16.3 37.7-28.8 75.9-34.5 116.7-3.2 23.4-5.8 46.5-5.7 70.1.1 23.6 2.7 46.7 6 70 5.8 40.7 18.6 78.9 35.1 116.4 16.1 36.5 38 69.3 63 100.2 25 31 54.8 57.1 86.9 80.5 32.5 23.6 68.4 41.4 105.9 55.5C436 967 522.4 971.3 604 955.3c80-15.7 154.8-55.7 214.8-110.6 29.6-27.1 55.5-59 76.9-92.9 21.6-34.4 38.5-72.5 50-111.5 5.1-17.3 9-34.8 11.6-52.6 2.5-8 2.9-16 1.1-23.9-.4-8-2.7-15.4-7.1-22.3-7.3-12.4-21.6-24.3-35.9-27.6-15.4-3.5-32.6-2.7-46.2 6-12.3 8-25.4 20.9-27.7 35.9z" fill="var(--cor-icons-anun)" class="fill-000000">
                  </path>
                </svg>
                {{ section.settings.anuncio_icons_text2 }}
              </p>
              <p class="announcement-bar__content announcement-bar__content--right mobhide">
                <svg
                  class="announcesvg"
                  viewBox="0 0 25 25"
                  xml:space="preserve"
                  xmlns="http://www.w3.org/2000/svg"
                  enable-background="new 0 0 25 25"
                >
                  <path d="M17.35 1.69c-1.84 0-3.55.68-4.85 1.89a7.072 7.072 0 0 0-4.85-1.89C3.71 1.69.5 4.9.5 8.84c0 6.15 9.99 13.39 11.13 14.2.26.18.56.28.87.28.32 0 .64-.1.91-.3 1.14-.86 11.09-8.56 11.09-14.17 0-3.95-3.21-7.16-7.15-7.16zm-4.88 18.24C8.68 17.06 3.5 12.05 3.5 8.84c0-2.29 1.86-4.15 4.15-4.15 1.47 0 2.8.76 3.56 2.03a1.507 1.507 0 0 0 2.58 0 4.12 4.12 0 0 1 3.56-2.03c2.29 0 4.15 1.86 4.15 4.15 0 2.89-5.21 8.04-9.03 11.09z" fill="var(--cor-icons-anun)" class="fill-000000">
                  </path>
                </svg>
                {{ section.settings.anuncio_icons_text3 }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <style>
      .announcement-bar {
        background: var(--anuncio-background);;
        color: {{ section.settings.text_color }};
      }
    </style>
    <script>
      {%- if section.settings.show_newsletter -%}
        document.documentElement.style.setProperty('--announcement-bar-button-width', document.querySelector('.announcement-bar__button').clientWidth + 'px');
      {%- else -%}
        document.documentElement.style.removeProperty('--announcement-bar-button-width');
      {%- endif -%}

      document.documentElement.style.setProperty('--announcement-bar-height', document.getElementById('shopify-section-{{ section.id }}').clientHeight + 'px');
    </script>
  {%- endif -%}
{%- endif -%}

{% schema %}
{
  "name": "Barra de Anúncio",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Mostrar barra de anúncio",
      "default": true
    },

    {
      "type": "checkbox",
      "id": "anuncio_icons",
      "label": "Barra de anúncio com icones",
      "info": "Barra de anúncios com ícones, de frete grátis, trocas e devoluções e satisfação garantida",
      "default": true
    },
    {
      "type": "color",
      "id": "cor_icons_anun",
      "label": "Cor dos ícones",
      "default": "#fff"
    },
    {
      "type": "text",
      "id": "anuncio_icons_text1",
      "label": "Texto 1 - Frete",
      "default": "Frete Grátis, Aproveite Hoje!"
    },

    {
      "type": "text",
      "id": "anuncio_icons_text2",
      "label": "Texto 2 - Garantia",
      "default": "Satisfação garantida ou dinheiro de volta!"
    },
    {
      "type": "text",
      "id": "anuncio_icons_text3",
      "label": "Texto 3 - Qualidade",
      "default": "Diversidade e Qualidade em um clique"
    },

    {
      "type": "range",
      "id": "anuncio_font_size",
      "label": "Tamanho da Fonte",
      "info": "Escolha o tamanho da fonte da barra de anúncios",
      "min": 10,
      "max": 20,
      "unit": "px",
      "default": 15
    },

    {
      "type": "color",
      "id": "text_color",
      "label": "Texto",
      "default": "#ffffff"
    },

    {
      "type": "checkbox",
      "id": "anuncio_padrao",
      "label": "Barra de anúncio padrão",
      "info": "Barra de anúncios padrão, apenas texto",
      "default": false
    },
    {
      "type": "text",
      "id": "text",
      "label": "Texto",
      "default": "O MELHOR TEMA 2023 PARA SHOPIFY"
    },
    {
      "type": "select",
      "id": "text_position",
      "label": "Posição do texto",
      "options": [
        {
          "value": "left",
          "label": "Esquerda"
        },
        {
          "value": "center",
          "label": "Centro"
        }
      ],
      "default": "left",
      "info": "Sempre alinhado ao centro no mobile"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link"
    },
    {
      "type": "header",
      "content": "Newsletter"
    },
    {
      "type": "paragraph",
      "content": "Os clientes que se inscreverem terão seus endereços de e-mail adicionados à \"accepts marketing\" [lista de clientes](/admin/customers?query=&accepts_marketing=1)."
    },
    {
      "type": "paragraph",
      "content": "Visível apenas no desktop"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter",
      "label": "Mostrar formulário de inscrição",
      "default": true
    },
    {
      "type": "text",
      "id": "newsletter_button",
      "label": "Botão de abertura",
      "default": "Inscrever e Salvar"
    },
    {
      "type": "text",
      "id": "newsletter_title",
      "label": "Título",
      "default": "Newsletter"
    },
    {
      "type": "richtext",
      "id": "newsletter_content",
      "label": "Texto",
      "default": "<p>Uma frase curta descrevendo o que alguém receberá ao se inscrever</p>"
    }
  ]
}
{% endschema %}
